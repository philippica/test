(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,i){e.exports=i(19)},16:function(e,t,i){},18:function(e,t,i){},19:function(e,t,i){"use strict";i.r(t);var a=i(1),n=i.n(a),o=i(6),r=i.n(o),s=(i(16),i(2)),c=i.n(s),h=i(3),l=i(0),m=i(4),u=i(8),d=i(7),f=i(9),g=function e(){var t=this;Object(l.a)(this,e),this.loadImage=function(e,i){var a=new Image,n=new Promise(function(n,o){a.onload=function(){t.images[e]=a,n(a)},a.onerror=function(){o("Could not load image: "+i)}});return a.src=i,n},this.getImage=function(e){return e in t.images?t.images[e]:null},this.images={}},w=function e(){var t=this;Object(l.a)(this,e),this.getTile=function(e,i,a){return t.layers[e][a*t.columns+i]},this.isSolidTileAtXY=function(e,i){var a=Math.floor(e/t.tileSize),n=Math.floor(i/t.tileSize);return t.layers.reduce(function(e,i,o){var r=t.getTile(o,a,n);return e||(2===r||5===r)},!1)},this.getColumn=function(e){return Math.floor(e/t.tileSize)},this.getRow=function(e){return Math.floor(e/t.tileSize)},this.getX=function(e){return e*t.tileSize},this.getY=function(e){return e*t.tileSize},this.columns=12,this.rows=12,this.tileSize=64,this.layers=[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,2,2,2,0,0,0,0,1,2,2,2,0,2,2,2,0,0,0,0,1,2,2,2,0,2,2,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,2,2,2,0,2,2,2,0,2,2,2,1,2,2,2,2,2,2,2,0,2,2,2,1,2,2,2,0,2,2,2,0,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]},p=function e(t,i,a){var n=this;Object(l.a)(this,e),this.follow=function(e){n.following=e,e.screenX=0,e.screenY=0},this.update=function(){n.following.screenX=n.width/2,n.following.screenY=n.height/2,n.x=n.following.x-n.width/2,n.y=n.following.y-n.height/2,n.x=Math.max(0,Math.min(n.x,n.maxX)),n.y=Math.max(0,Math.min(n.y,n.maxY)),(n.following.x<n.width/2||n.following.x>n.maxX+n.width/2)&&(n.following.screenX=n.following.x-n.x),(n.following.y<n.height/2||n.following.y>n.maxY+n.height/2)&&(n.following.screenY=n.following.y-n.y)},this.x=0,this.y=0,this.width=i,this.height=a,this.maxX=t.columns*t.tileSize-i,this.maxY=t.rows*t.tileSize-a},y=function e(){var t=this;Object(l.a)(this,e),this.listenForEvents=function(e){window.addEventListener("keydown",t._onKeyDown),window.addEventListener("keyup",t._onKeyUp),e.forEach(function(e){t._keys[e]=!1})},this._onKeyDown=function(e){var i=e.keyCode;i in t._keys&&(e.preventDefault(),t._keys[i]=!0)},this._onKeyUp=function(e){var i=e.keyCode;i in t._keys&&(e.preventDefault(),t._keys[i]=!1)},this.isDown=function(e){if(!e in t._keys)throw new Error("Keycode  ".concat(e," is not being listened to"));return t._keys[e]},this.LEFT=37,this.RIGHT=39,this.UP=38,this.DOWN=40,this._keys={}},x=function e(t,i,a,n){var o=this;Object(l.a)(this,e),this.move=function(e,t,i){o.x+=t*o.SPEED*e,o.y+=i*o.SPEED*e,o._collide(t,i);var a=o.map.columns*o.map.tileSize,n=o.map.rows*o.map.tileSize;o.x=Math.max(0,Math.min(o.x,a)),o.y=Math.max(0,Math.min(o.y,n))},this._collide=function(e,t){var i,a,n=o.x-o.width/2,r=o.x+o.width/2-1,s=o.y-o.height/2,c=o.y+o.height/2-1;(o.map.isSolidTileAtXY(n,s)||o.map.isSolidTileAtXY(r,s)||o.map.isSolidTileAtXY(r,c)||o.map.isSolidTileAtXY(n,c))&&(t>0?(i=o.map.getRow(c),o.y=-o.height/2+o.map.getY(i)):t<0?(i=o.map.getRow(s),o.y=o.height/2+o.map.getY(i+1)):e>0?(a=o.map.getColumn(r),o.x=-o.width/2+o.map.getX(a)):e<0&&(a=o.map.getColumn(n),o.x=o.width/2+o.map.getX(a+1)))},this.map=t,this.x=i,this.y=a,this.width=t.tileSize,this.height=t.tileSize,this.image=n,this.SPEED=256},v=function(){function e(t){var i=this;Object(l.a)(this,e),this.init=Object(h.a)(c.a.mark(function e(){var t,a;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i.keyboard.listenForEvents([i.keyboard.LEFT,i.keyboard.RIGHT,i.keyboard.UP,i.keyboard.DOWN]),e.next=3,i.loader.loadImage("tiles","./assets/tiles.png");case 3:return t=e.sent,e.next=6,i.loader.loadImage("character","./assets/character.png");case 6:a=e.sent,i.tileAtlas=i.loader.getImage("tiles"),i.images={tiles:t,character:a},i.hero=new x(i.map,30,720,i.images.character),i.camera=new p(i.map,512,512),i.camera.follow(i.hero);case 12:case"end":return e.stop()}},e)})),this.drawLayer=function(e){for(var t=Math.floor(i.camera.x/i.map.tileSize),a=t+i.camera.width/i.map.tileSize,n=Math.floor(i.camera.y/i.map.tileSize),o=n+i.camera.height/i.map.tileSize,r=-i.camera.x+t*i.map.tileSize,s=-i.camera.y+n*i.map.tileSize,c=t;c<a;c++)for(var h=n;h<o;h++){var l=i.map.getTile(e,c,h),m=(c-t)*i.map.tileSize+r,u=(h-n)*i.map.tileSize+s;0!==l&&i.context.drawImage(i.tileAtlas,(l-1)*i.map.tileSize,0,i.map.tileSize,i.map.tileSize,Math.round(m),Math.round(u),i.map.tileSize,i.map.tileSize)}},this._drawGrid=function(){for(var e,t,a=i.map.columns*i.map.tileSize,n=i.map.rows*i.map.tileSize,o=0;o<i.map.rows;o++)e=-i.camera.x,t=o*i.map.tileSize-i.camera.y,i.context.beginPath(),i.context.moveTo(e,t),i.context.lineTo(a,t),i.context.stroke();for(var r=0;r<i.map.columns;r++)e=r*i.map.tileSize-i.camera.x,t=-i.camera.y,i.context.beginPath(),i.context.moveTo(e,t),i.context.lineTo(e,n),i.context.stroke()},this.update=function(e){var t=0,a=0;i.keyboard.isDown(i.keyboard.LEFT)&&(t=-1),i.keyboard.isDown(i.keyboard.RIGHT)&&(t=1),i.keyboard.isDown(i.keyboard.UP)&&(a=-1),i.keyboard.isDown(i.keyboard.DOWN)&&(a=1),i.hero.move(e,t,a),i.camera.update()},this.getDelta=function(e){var t=(e-i._previousElapsed)/1e3;return t=Math.min(t,.25),i._previousElapsed=e,t},this.context=t,this.loader=new g,this.map=new w,this.keyboard=new y,this._previousElapsed=0}return Object(m.a)(e,[{key:"render",value:function(e){this.context.clearRect(0,0,512,512),this.update(this.getDelta(e)),this.drawLayer(0),this.context.drawImage(this.hero.image,this.hero.screenX-this.hero.width/2,this.hero.screenY-this.hero.height/2),this.drawLayer(1),this._drawGrid()}}]),e}(),S=(i(18),function(e){function t(e){var i;return Object(l.a)(this,t),(i=Object(u.a)(this,Object(d.a)(t).call(this,e))).componentDidMount=function(){i.start()},i.start=Object(h.a)(c.a.mark(function e(){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i.state.isGameRunning){e.next=5;break}return i.game=new v(i.getContext()),e.next=4,i.game.init();case 4:i.renderGame();case 5:i.setState(function(e){return{isGameRunning:!e.isGameRunning}});case 6:case"end":return e.stop()}},e)})),i.renderGame=function(){requestAnimationFrame(function(e){i.game.render(e),i.state.isGameRunning&&i.renderGame()})},i.getContext=function(){return i.canvasRef.current.getContext("2d")},i.state={isGameRunning:!1},i.canvasRef=n.a.createRef(),i}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){return n.a.createElement("div",null,n.a.createElement("div",{className:"header"},"Tilemaps examples (with React)"),n.a.createElement("div",{className:"subheader"},"Collisions"),n.a.createElement("div",{className:"subheader2"},"Use arrow keys to move"),n.a.createElement("div",{className:"gameContainer"},n.a.createElement("canvas",{ref:this.canvasRef,width:512,height:512})))}}]),t}(a.Component));r.a.render(n.a.createElement(S,null),document.getElementById("root"))}},[[10,1,2]]]);
//# sourceMappingURL=main.7d0b1f00.chunk.js.map